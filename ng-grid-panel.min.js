/**
 * @license ngGridPanel
 * (c) 2014 Hacklone https://github.com/Hacklone
 * License: MIT
 */
angular.module("ngGridPanel",["ngAnimate"]).directive("gridPanel",["$animate","$compile","$window","$document",function(e,n,t,i){return{restrict:"AE",compile:function(r,o){function a(){var e=r.find("grid-panel-item, .grid-panel-item").clone();if(!e.length)throw new Error("grid-panel-item template must be set");return e}function l(){var e=r.find("grid-panel-content, .grid-panel-content").clone();if(!e.length)throw new Error("grid-panel-content template must be set");return e.prepend(angular.element('<div class="close-x">')).prepend(angular.element('<div class="triangle">')),e}var c=angular.element(t),d=angular.element(i).find("html, body"),u=a(),f=l();if(!o.repeat)throw new Error("repeat attribute must be set");var s=o.repeat.match(/\s?(.*)\sin\s(.*)\s?/);if(!s||s.length<3)throw new Error('repeat attribute must be set like repeat="item in items"');var g,m,p,h=s[1],v=s[2];return{pre:function(t,i){function r(){t.$watchCollection(v,o)}function o(r){i.empty();for(var o=0,l=r.length;l>o;o++){var c=t.$new(),d=r[o];c[h]=d;var f=u.clone();f.addClass("grid-panel-item-"+o).on("click",function(e,n,t){return function(){a(e,n,t)}}(o,d,l)),e.enter(f,i),n(f)(c)}}function a(r,o,a){function l(e){var n=i.innerWidth(),t=e.outerWidth(!0);return Math.floor(n/t)}function u(){m=y;var r=i.find(".grid-panel-item-"+y);v(),p=t.$new(),p[h]=o,g=f.clone(),g.find(".close-x").on("click",v),e.enter(g,null,r),n(g)(p),p.$digest()}function s(){p[h]=o,p.$digest()}function v(){g&&(e.leave(g),g=void 0),p&&(p.$destroy(),p=void 0),t.$digest()}function w(){if(g){var e=b.offset().top;e>c.scrollTop()+c.height()/2&&d.animate({scrollTop:e-b.outerHeight(!0)},500)}}function $(){g&&g.find(".triangle").css({left:b.position().left+b.width()/2})}var b=i.find(".grid-panel-item-"+r),E=l(b),k=r%E,y=E-k-1+r;y>=a&&(y=a-1),g&&m===y?s():u(),$(),w()}r()}}}}}]);