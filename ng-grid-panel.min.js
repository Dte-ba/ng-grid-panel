/**
 * @license ngGridPanel
 * (c) 2014 Hacklone https://github.com/Hacklone
 * License: MIT
 */
angular.module("ngGridPanel",["ngAnimate"]).directive("gridPanel",["$animate","$compile","$window","$document",function(e,t,n,r){return{restrict:"AE",compile:function(i,o){function a(){var e=i.find("grid-panel-item, .grid-panel-item").clone();if(!e.length)throw new Error("grid-panel-item template must be set");return e}function l(){var e=i.find("grid-panel-content, .grid-panel-content").clone();if(!e.length)throw new Error("grid-panel-content template must be set");return e.prepend(angular.element('<div class="close-x">')).prepend(angular.element('<div class="triangle">')),e}var c=angular.element(n),f=angular.element(r).find("html, body"),u=a(),s=l();if(!o.repeat)throw new Error("repeat attribute must be set");var d=o.repeat.match(/\s?(.*)\sin\s(.*)\s?/);if(!d||d.length<3)throw new Error('repeat attribute must be set like repeat="item in items"');var p,g,m,v=d[1],h=d[2];return{pre:function(n,r){function i(){n.$watchCollection(h,o)}function o(i){r.empty();for(var o=0,l=i.length;l>o;o++){var c=n.$new(),f=i[o];c[v]=f;var s=u.clone();s.addClass("grid-panel-item-"+o).on("click",function(e,t){return function(){a(e,t)}}(o,f)),e.enter(s,r),t(s)(c)}}function a(i,o){function a(e){for(var t=e,n=e.next();n&&t.offset().top===n.offset().top;)t=n,n=t.next();return t}function l(){g=E,d(),m=n.$new(),m[v]=o,p=s.clone(),p.find(".close-x").on("click",d),e.enter(p,null,b),t(p)(m),m.$digest()}function u(){m[v]=o,m.$digest()}function d(){p&&(e.leave(p),p=void 0),m&&(m.$destroy(),m=void 0),n.$digest()}function h(){if(p){var e=$.offset().top;e>c.scrollTop()+c.height()/2&&f.animate({scrollTop:e-$.outerHeight(!0)},500)}}function w(){p&&p.find(".triangle").css({left:$.position().left+$.width()/2})}var $=r.find(".grid-panel-item-"+i),b=a($),E=b.attr("class");p&&g===E?u():l(),w(),h()}i()}}}}}]);