/**
 * @license ngGridPanel
 * (c) 2014 Hacklone https://github.com/Hacklone
 * License: MIT
 */
angular.module("ngGridPanel",["ngAnimate"]).directive("gridPanel",["$animate","$compile","$window","$document",function(e,n,t,r){return{restrict:"AE",compile:function(i,o){function a(){var e=i.find("grid-panel-item, .grid-panel-item").clone();if(!e.length)throw new Error("grid-panel-item template must be set");return e}function l(){var e=i.find("grid-panel-content, .grid-panel-content").clone();if(!e.length)throw new Error("grid-panel-content template must be set");return e.before().prepend(angular.element('<div class="close-x">')),e}var c=a(),u=l();if(!o.repeat)throw new Error("repeat attribute must be set");var d=o.repeat.match(/\s?(.*)\sin\s(.*)\s?/);if(!d||d.length<3)throw new Error('repeat attribute must be set like repeat="item in items"');var f,m,s,g=d[1],p=d[2];return{pre:function(i,o){function a(){i.$watchCollection(p,l)}function l(t){o.empty();for(var r=0,a=t.length;a>r;r++){var l=i.$new(),u=t[r];l[g]=u;var f=c.clone();f.addClass("grid-panel-item-"+r).on("click",function(e,n,t){return function(){d(e,n,t)}}(r,u,a)),e.enter(f,o),n(f)(l)}}function d(a,l,c){function d(e){var n=o.innerWidth(),t=e.outerWidth(!0);return Math.floor(n/t)}function p(){m=k;var t=o.find(".grid-panel-item-"+k);v(),s=i.$new(),s[g]=l,f=u.clone(),f.find(".close-x").on("click",v),e.enter(f,null,t),n(f)(s),s.$digest()}function h(){s[g]=l,s.$digest()}function v(){f&&(e.leave(f),f=void 0),s&&(s.$destroy(),s=void 0),i.$digest()}function w(){if(f){var e=angular.element(t),n=$.offset().top;n>e.scrollTop()+e.height()/2&&angular.element(r).find("html, body").animate({scrollTop:n-$.outerHeight(!0)},500)}}var $=o.find(".grid-panel-item-"+a),b=d($),E=a%b,k=b-E-1+a;k>=c&&(k=c-1),f&&m===k?h():p(),w()}angular.extend(i,{onGridItemClick:d}),a()}}}}}]);